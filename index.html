<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Acerte a Senha</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        .game-container {
            display: inline-block;
            margin: 20px;
        }
        .row {
            display: flex;
            gap: 5px;
            margin: 5px 0;
        }
        .slot {
            width: 40px;
            height: 40px;
            border: 2px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
        }
        .yellow {
            background-color: #ffeb3b;
        }
        .green {
            background-color: #4caf50;
        }
        input {
            width: 30px;
            text-align: center;
            font-size: 16px;
        }
        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
        }
        #result {
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Acerte a Senha</h1>
    <p>Tente adivinhar a senha de 4 dígitos (0-9). Você tem 4 tentativas!</p>
    <div class="game-container" id="game">
        <div class="row" id="row1"></div>
        <div class="row" id="row2"></div>
        <div class="row" id="row3"></div>
        <div class="row" id="row4"></div>
        <div class="row">
            <input type="number" min="0" max="9" id="in1">
            <input type="number" min="0" max="9" id="in2">
            <input type="number" min="0" max="9" id="in3">
            <input type="number" min="0" max="9" id="in4">
        </div>
        <button onclick="checkGuess()">Enviar</button>
    </div>
    <div id="result"></div>

    <script>
        const currentDate = new Date('March 12, 2025'); // Data fixa para exemplo
        const attempts = [];
        let attemptCount = 0;

        // Geração da senha baseada na data (cálculo obfuscado)
        function generatePassword() {
            const day = currentDate.getDate();
            const month = currentDate.getMonth() + 1;
            const year = currentDate.getFullYear();
            
            // Cálculo complexo para gerar senha única
            let seed = (year * 13 + month * 17 + day * 23) % 10000;
            const password = String(seed).padStart(4, '0').split('').map(Number);
            return password;
        }

        const correctPassword = generatePassword();

        // Carrega tentativas salvas
        function loadAttempts() {
            const saved = localStorage.getItem('passwordGame_' + currentDate.toDateString());
            if (saved) {
                const data = JSON.parse(saved);
                attempts.push(...data.attempts);
                attemptCount = data.attemptCount;
                updateBoard();
                if (data.won || attemptCount >= 4) {
                    endGame(data.won);
                }
            }
        }

        // Salva tentativas no localStorage
        function saveAttempts(won = false) {
            localStorage.setItem('passwordGame_' + currentDate.toDateString(), 
                JSON.stringify({ attempts, attemptCount, won }));
        }

        // Atualiza o tabuleiro
        function updateBoard() {
            for (let i = 0; i < attempts.length; i++) {
                const row = document.getElementById(`row${i + 1}`);
                row.innerHTML = '';
                const guess = attempts[i];
                const tempPassword = [...correctPassword];
                
                // Primeiro marca os verdes (acertos exatos)
                for (let j = 0; j < 4; j++) {
                    const slot = document.createElement('div');
                    slot.classList.add('slot');
                    slot.textContent = guess[j];
                    if (guess[j] === tempPassword[j]) {
                        slot.classList.add('green');
                        tempPassword[j] = null; // Remove para não contar novamente
                    }
                    row.appendChild(slot);
                }

                // Depois marca os amarelos (dígitos certos, posição errada)
                for (let j = 0; j < 4; j++) {
                    if (!row.children[j].classList.contains('green')) {
                        const digit = guess[j];
                        const index = tempPassword.indexOf(digit);
                        if (index !== -1) {
                            row.children[j].classList.add('yellow');
                            tempPassword[index] = null;
                        }
                    }
                }
            }
        }

        // Verifica o palpite
        function checkGuess() {
            if (attemptCount >= 4) return;

            const inputs = [
                Number(document.getElementById('in1').value),
                Number(document.getElementById('in2').value),
                Number(document.getElementById('in3').value),
                Number(document.getElementById('in4').value)
            ];

            if (inputs.some(n => isNaN(n) || n < 0 || n > 9)) {
                document.getElementById('result').textContent = 'Digite apenas números de 0 a 9!';
                return;
            }

            attempts.push(inputs);
            attemptCount++;
            updateBoard();
            saveAttempts();

            const won = inputs.every((n, i) => n === correctPassword[i]);
            if (won) {
                saveAttempts(true);
                endGame(true);
            } else if (attemptCount === 4) {
                endGame(false);
            }

            // Limpa os inputs
            document.getElementById('in1').value = '';
            document.getElementById('in2').value = '';
            document.getElementById('in3').value = '';
            document.getElementById('in4').value = '';
        }

        // Finaliza o jogo
        function endGame(won) {
            const resultDiv = document.getElementById('result');
            if (won) {
                const shareText = `Acertei a senha do dia ${currentDate.toLocaleDateString('pt-BR')} em ${attemptCount}/4 tentativas!\n` +
                    attempts.map(a => a.join('')).join('\n');
                resultDiv.innerHTML = `Parabéns! Você acertou a senha em ${attemptCount} tentativa(s)!<br>` +
                    `<textarea readonly>${shareText}</textarea>`;
            } else {
                resultDiv.textContent = `Fim de jogo! A senha era ${correctPassword.join('')}. Tente novamente amanhã!`;
            }
            document.querySelector('button').disabled = true;
            document.querySelectorAll('input').forEach(input => input.disabled = true);
        }

        // Inicializa o jogo
        loadAttempts();
    </script>
</body>
</html>
